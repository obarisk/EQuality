{
    "contents" : "library(shiny)\n\nN2p <- function(nSubj, rc=.1, nCond=2){\n  Fcut <- (rc*rc/(nCond-1))/((1-rc*rc)/(nSubj-nCond))\n  return( 1-pf(Fcut, nCond-1, nSubj-nCond) )\n}\n\nq2N <- function(q ,rc=.1, nCond=2){\n  nUpper <- nCond+1\n  p0 <- N2p(nUpper, rc, nCond)\n  if( p0 <= (1-q) ) return( NA )\n  while ( p0 > (1-q) ){\n    nUpper <- nUpper*10\n    p0 <-  N2p(nUpper, rc, nCond)\n  }\n  return(uniroot(function(N) {N2p(N, rc, nCond)-(1-q)}, \n                              lower = nCond+1, upper = nUpper, tol = 1e-9)$root)\n}\n\nshinyServer(function(input, output) {\n  \n  output$pvalue <- renderText({\n    input$RUN_p\n    N <- isolate(input$N_p)\n    rc <- isolate(input$rc_p)\n    L <- isolate(input$L_p)\n    pvalue <- round(1-N2p(N, rc, L), 3)\n    if( is.nan(pvalue) ){\n      \"NaN\"\n    }else{\n      pvalue\n    }\n  })\n\n  output$NSubj <- renderText({\n    input$RUN_n\n    Q <- isolate(input$Q_n)\n    rc <- isolate(input$rc_n)\n    L <- isolate(input$L_n)\n    N <- ceiling(q2N(Q, rc, L)/L)\n  })\n\n})\n",
    "created" : 1417150599841.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1288051317",
    "id" : "BE90CA94",
    "lastKnownWriteTime" : 1417100386,
    "path" : "/mnt/files/owncloud/EQuality/EQuality_Shiny/Calculator/server.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}